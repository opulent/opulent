{"version":3,"sources":["smoothscroll/smoothscroll.coffee"],"names":[],"mappings":"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","file":"smoothscroll/smoothscroll.js","sourceRoot":"/source/","sourcesContent":["(($, window, document) ->\n  \"use strict\"\n\n  $.smoothscroll = (element, options) ->\n    _defaults =\n      friction: 0.95\n      direction: undefined\n      on_render: null\n      step_amount: 1\n      min_movement: 0.1\n\n    @container = $(element)\n\n    @running = false\n\n    @max_scroll_top = 0\n    @min_scroll_top = undefined\n\n    @current_y = 0\n    @target_y = 0\n    @old_y = 0\n    @vy = 0\n\n\n    @initialize = =>\n      #  var args = [].splice.call(arguments, 0);\n      @settings = $.extend {}, _defaults, options\n\n      if !('ontouchstart' of window)\n        @container.bind 'mousewheel DOMMouseScroll', @on_wheel\n\n        @target_y = @old_y = @container.scrollTop()\n        @current_y = -@target_y\n\n        @min_scroll_top = @container.get(0).clientHeight - (@container.get(0).scrollHeight)\n\n        if !@running\n          @running = true\n          @animate_loop()\n      return\n\n    @remove = =>\n      @running = false\n      @container.unbind 'mousewheel', @on_wheel\n      @container.unbind 'DOMMouseScroll', @on_wheel\n      return\n\n    @update_scroll_target = (amt) =>\n      @target_y += amt\n      @vy += (@target_y - @old_y) * @settings.step_amount\n      @old_y = @target_y\n      return\n\n    @render = =>\n      if @vy < -@settings.min_movement or @vy > @settings.min_movement\n        @current_y = @current_y + @vy\n\n        if @current_y > @max_scroll_top\n          @vy = 0\n          @current_y = 0\n        else if @current_y < @min_scroll_top\n          @vy = 0\n          @current_y = @min_scroll_top\n\n        @container.scrollTop -@current_y\n        @vy *= @settings.friction\n\n        if @settings.on_render\n          @settings.on_render()\n      return\n\n    @animate_loop = =>\n      if !@running\n        return\n      window.request_animation_frame @animate_loop\n      @render()\n      return\n\n    @on_wheel = (e) =>\n      e.preventDefault()\n\n      event = e.originalEvent\n\n      if e.type is 'DOMMouseScroll' and event.detail?\n        delta = event.detail * -1\n      else if event.wheelDelta?\n        delta = event.wheelDelta.toFixed(2) / 40\n      else if event.deltaY?\n        delta = event.deltaY.toFixed(2) / -10\n\n      dir = if delta < 0 then -1 else 1\n\n      if dir != @settings.direction\n        @vy = 0\n        @settings.direction = dir\n\n      #reset @current_y in case non-wheel scroll has occurred (scrollbar drag, etc.)\n      @current_y = -@container.scrollTop()\n\n      # console.log delta, event.detail, event.wheelDelta, event.deltaY\n\n      @update_scroll_target delta\n\n      return\n\n    @initialize()\n    return\n\n  ###\n  # http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n  ###\n  window.request_animation_frame = do =>\n    window.requestAnimationFrame or window.webkitRequestAnimationFrame or window.mozRequestAnimationFrame or window.oRequestAnimationFrame or window.msRequestAnimationFrame or (callback) ->\n      window.setTimeout callback, 1000 / 60\n      return\n\n  ###\n  # http://jsbin.com/iqafek/2/edit\n  ###\n  normalize_wheel_delta = do =>\n    # Keep a distribution of observed values, and scale by the\n    # 33rd percentile.\n    distribution = []\n    done = null\n    scale = 30\n    (n) =>\n      # Zeroes don't count.\n      if n == 0\n        return n\n      # After 500 samples, we stop sampling and keep current factor.\n      if done != null\n        return n * done\n      abs = Math.abs(n)\n      # Insert value (sorted in ascending order).\n\n      outer = ->\n        i = 0\n        while i < distribution.length\n          if abs <= distribution[i]\n            distribution.splice i, 0, abs\n            outer()\n            break\n          ++i\n        distribution.push abs\n        return\n\n      # Factor is scale divided by 33rd percentile.\n      factor = scale / distribution[Math.floor(distribution.length / 3)]\n      if distribution.length == 500\n        done = factor\n      n * factor\n\n  $.fn.smoothscroll = (opts) ->\n    @each (index, element) ->\n      unless $.data element, \"smoothscroll\"\n        $.data element, \"smoothscroll\", new $.smoothscroll element, opts\n\n\n  return\n) window.jQuery, window, document\n"]}