(function(){!function(t,e,n){"use strict";return t.revelate=function(i,a){var r;return r={selector:"[data-revelate]",delay:400,edge:[150,150],screen:[1920,1080],repeat:!1,direction:"vertical",animation:{duration:700,easing:"swing"}},this._defaults=r,this.settings=t.extend({},r,a),this.context=t(i),this.debug&&console.log(this.elements),this.initialize=function(t){return function(){t.init_animus(),t.init_window(),t.init_elements(),t.bind_resize(),t.bind_scroll()}}(this),this.init_animus=function(e){return function(){var n;n={duration:e.settings.animation.duration,easing:e.settings.animation.easing},e.animus=new t.animus(n)}}(this),this.init_window=function(i){return function(){var a,r,s,o;i.edge=i.settings.edge.slice(0),"vertical"===i.settings.direction?(s=t(e).height(),a=t(n).height(),i.edge=i.edge.map(function(t){return parseInt(t*(s/i.settings.screen[1]))}),i.viewport=s-i.edge[1],i.endscroll=a-s):(o=t(e).width(),r=t(n).width(),i.edge=i.edge.map(function(t){return parseInt(t*(o/i.settings.screen[0]))}),i.viewport=o-i.edge[1],i.endscroll=r-s),i.debug&&(console.log("Edge: ",i.edge),console.log("Viewport: ",i.viewport),console.log("End Scroll: ",i.endscroll))}}(this),this.init_elements=function(e){return function(){e.elements={},t(e.settings.selector,e.context).each(function(n,i){var a,r;return r=e.get_offset(t(i)),a=e.get_data(t(i)),null==e.elements[r]&&(e.elements[r]=new Array),e.elements[r].push(a),t(i).attr("data-revelate-index",r+"-"+(e.elements[r].length-1)),t(i).velocity(a.starting_animation.state,1)})}}(this),this.get_offset=function(t){var e;return e="vertical"===this.settings.direction?Math.round(t.offset().top):Math.round(t.offset().left),0>e&&(e=0),e},this.get_data=function(e){var n,i,a,r,s,o,l,u,d,c,h,g,v;a={done:!1,height:e.outerHeight(!0),width:e.outerWidth(!0),animation:{}},u=e.attr("data-revelate-repeat"),a.repeat=null==u?this.settings.repeat:!!u,d=e.attr("data-revelate-start"),d=null==d?this.settings.delay:parseInt(d),h=[],n={},r=e.attr("data-revelate"),null==r&&(r=e.attr("data-revelate-initial")),n[d]=r,h.push(d),s=null!=e.attr("data-revelate-in")?this.animus.get(e.attr("data-revelate-in")):!1,g=e.data();for(o in g)v=g[o],null!==(i=o.match(/revelateAt([0-9]*)/))&&(c=parseInt(i[1],10),n[c]=v,h.push(c));h.sort(),l=h[0];for(o in h)a.animation[h[o]]=this.animus.get(n[h[o]]),h[o]>l&&(l=h[o]);return"string"!==t.type(a.animation[d].state)&&(a.animation[d].state=this.animus.reset(a.animation[d].state,a,!0),a.starting_animation=a.animation[d],a.animation[d].state=this.animus.forcefeed(a.animation[d].state,s)),a.loop=null!=e.attr("data-revelate-loop")?l+a.animation[l].duration+1:!1,a},this.bind_resize=function(n){return function(){var i;i=null,t(e).resize(function(){return clearTimeout(i),i=setTimeout(function(){var t;return n.init_window(),n.elements=n.restructure(),t=n.window.scrollTop(),n.check(t)},500)})}}(this),this.restructure=function(e){return function(){var n;return n={},t(e.settings.selector,e.context).each(function(i,a){var r,s,o,l,u;return s=t(a).attr("data-revelate-index"),u=s.split("-"),l=u[0],i=u[1],i=parseInt(i),o=e.get_offset(t(a)),null==n[o]&&(n[o]=new Array),n[o].push(e.elements[l][i]),r=n[o].length-1,n[o][r].width=t(a).outerWidth(!0),n[o][r].height=t(a).outerHeight(!0),t(a).attr("data-revelate-index",o+"-"+(n[o].length-1))}),e.debug&&console.log("Restructured: ",e.elements),n}}(this),this.bind_scroll=function(n){return function(){return n.window=t(e),n.window.scroll(function(){var t;return t=n.window.scrollTop(),n.check(t)}),n.window.trigger("scroll")}}(this),this.check=function(e){var n,a,r,s,o,l;l=this.elements;for(o in l){a=l[o];for(s in a)n=a[s],this.in_viewport(o,n.height,e)?n.done===!1&&(r=o+"-"+s,i=t('[data-revelate-index="'+r+'"]'),this.animate(i,n),this.debug&&console.log("Animate: ["+e+", "+o+"]")):n.repeat===!0&&n.done===!0&&(r=o+"-"+s,i=t('[data-revelate-index="'+r+'"]'),this.reset(i,n))}},this.in_viewport=function(t,e,n){var i,a,r,s,o;return o=parseInt(t),i=o+e,s=0===n?[0,n+this.viewport]:n===this.endscroll?[n+this.edge[0],n+this.viewport+this.edge[1]]:[n+this.edge[0],n+this.viewport],r=s[0],a=s[1],o>=r&&a>=i||r>o&&i>r&&a>i||o>r&&a>o&&i>a||r>o&&i>a},this.animate=function(e,n){var i;i=function(){return t.each(n.animation,function(t,n){return n.timeline=setTimeout(function(){e.velocity(n.state,{easing:n.easing,duration:n.duration,visibility:"visible"})},t)})},n.done=!0,i(),n.loop&&(n.interval=setInterval(i,n.loop))},this.reset=function(t,e){var n,i,a;e.done=!1,e.loop&&clearInterval(e.interval),a=e.animation;for(i in a)n=a[i],clearTimeout(n.timeline);t.velocity(e.starting_animation.state,{duration:e.starting_animation.duration,visibility:"hidden"})},this.initialize()},t.fn.revelate=function(e){return this.each(function(n,i){return t.data(i,"revelate")?void 0:t.data(i,"revelate",new t.revelate(i,e))})}}(window.jQuery,window,document)}).call(this);